#!/bin/bash

IMAGE="ghcr.io/isam-ahmed0/mbx:minimal-brave-xubuntu"
CONTAINER="minimal-brave-desktop"
WEB_PORT=6901
VNC_PORT=5901

# Check Docker
if ! command -v docker >/dev/null 2>&1; then
  echo "Docker is not installed."
  exit 1
fi

# Check if container already exists
if docker ps -a --format '{{.Names}}' | grep -w "$CONTAINER" >/dev/null; then
  echo "MBX is already running permanently in the background."
  exit 0
fi

echo "Pulling image..."
docker pull "$IMAGE"

echo "Starting MBX (permanent background mode)..."
docker run -d \
  --name minimal-brave-desktop \
  --platform=linux/amd64 \
  -p 6901:6901 \
  -p 5901:5901 \
  -v mbx-home:/home/ubuntu \
  --restart unless-stopped \
  ghcr.io/isam-ahmed0/mbx:minimal-brave-xubuntu

echo "MBX is live."
echo "Web: http://localhost:${WEB_PORT}"
